<html>
<head>
    <script type="text/javascript">

        Ext.onReady(function()
        {

            var userName = LABKEY.Security.currentUser.displayName;
            var userName = 'ABBOTT';

            //we find this employee's info
            var employeeRecord = new LABKEY.ext.Store({
                schemaName: 'lists',
                queryName: 'Employees',
                //need to update once we have real unique IDs in the tables
                filterArray: [LABKEY.Filter.create('LastName', userName, LABKEY.Filter.Types.EQUAL)
                ]
            });

            employeeRecord.on('load', loadRequirements)
            employeeRecord.load();

            function loadRequirements()
            {
                alert(employeeRecord);

                var employeeCategory = 'CLINPATH';

                //we display a list of all requirements for this person
                var requirementStore = new LABKEY.ext.Store({
                    schemaName: 'lists',
                    queryName: 'ComplianceRecentTests',
                    //need to update once we have real unique IDs in the tables
                    filterArray: [LABKEY.Filter.create('TestRequired', true, LABKEY.Filter.Types.EQUAL), LABKEY.Filter.create('LastName', userName, LABKEY.Filter.Types.EQUAL)
                    ],
                    sort: 'RequirementName'
                });

                var requirementGrid = new LABKEY.ext.EditorGridPanel({
                    store: requirementStore
                    ,applyTo: 'myRequirementsDiv'
                    ,width: 1000
                    ,autoHeight: true
                    ,title: 'My Requirements'
                    ,editable: false
                    ,stripeRows: true
                    ,disableSelection: true
                });

            }

        });


    </script>
</head>

<body>
<p>

<div id='myRequirementsDiv'>
    <div>


</body>
</html>