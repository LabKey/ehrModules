

<script type="text/javascript">

LABKEY.requiresScript("fileBrowser.js");
var EHR = {};

Ext.onReady(function(){
    EHR.WebdavFileSystem = function(config){
        EHR.WebdavFileSystem.superclass.constructor.call(this, config);
    };

    Ext.extend(EHR.WebdavFileSystem, LABKEY.WebdavFileSystem, {
        movePath : function(source, dest, isFile, callback){

            try
            {
                var resourcePath = this.concatPaths(this.prefixUrl, LABKEY.ActionURL.encodePath(source));
                var destinationPath = this.concatPaths(this.prefixUrl, LABKEY.ActionURL.encodePath(dest));
                var fileSystem = this;
                var connection = new Ext.data.Connection();
                connection.handleResponse = function(response)
                {
                    if (204 == response.status || 404 == response.status) // NO_CONTENT (success), NOT_FOUND (actually goes to handleFailure)
                    {
                        // CONSIDER just delete one entry
                        if (!isFile)
                            fileSystem.uncacheListing(source);
                        else
                            fileSystem.uncacheListing(fileSystem.parentPath(source));
                        callback(fileSystem, true, source, dest, response);
                    }
                    else if (405 == response.status) // METHOD_NOT_ALLOWED
                        callback(fileSystem, false, source, dest, response);
                    else
                        window.alert(response.statusText);
                }
                connection.request({method:"MOVE", url:resourcePath, Destination: destinationPath});
            }
            catch (x)
            {
                window.alert(x);
            }
            return true;
        },

        copyPath: function(){

        }

//        copyFile: function(){
//
//        },
//
//        moveFile: function(){
//
//        },
//
//        deleteFile: function(){
//
//        }

    });

    var rootPath = LABKEY.ActionURL.getContainer()+'/@pipeline/';
//    console.log(rootPath)
    var wd = new EHR.WebdavFileSystem({
        //baseUrl: baseurl,
        rootPath: rootPath
    });

    console.log(wd);
});





</script>