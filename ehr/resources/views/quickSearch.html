<html>
<head>

<script type="text/javascript">

LABKEY.requiresScript("/ehr/utils.js");

Ext.onReady(makePanel)

function makePanel(){
    if (!window.EHR || !window.EHR.ext || !window.EHR.utils)
    {
        makePanel.defer(10);
        return;
    }

    var thePanel = Ext.extend(Ext.Panel, {
        initComponent: function(){

            Ext.apply(this, {
                layout: 'table'
                ,width: 280
                ,bodyBorder: false
                ,border: false
                ,defaults: {
                    border: false
                    ,bodyStyle:'align:left'
                },
                layoutConfig: {
                    columns: 2
                }
            })

            thePanel.superclass.initComponent.apply(this, arguments);

            this.add({html: 'Animal:', colspan: 2});

            this.animalField = this.add(new Ext.form.TextField({
                type: 'textbox'
               ,name: 'animal'
               ,width: 160
                })
            );


            this.add(new Ext.Button({
                text: 'Show Animal'
                ,width: 120
                ,style: 'padding-left:5px'
                ,handler: function(){
                    var value = this.animalField.getValue();
                    if (!value) return false;

                    window.location = LABKEY.ActionURL.buildURL(
                        'study'
                        ,'participant'
                        ,'WNPRC/EHR/'
                        ,{participantId: value}
                        );
                }
                ,scope: this
                })
            );

            this.add({html: '<a href="'+(LABKEY.ActionURL.buildURL('ehr','animalSearch','WNPRC/EHR/'))+'">Advanced Animal Search</a>', colspan: 2});

            this.add({html: '<Br>Animal Groups:', colspan: 2});

            this.animalGroup = this.add({
                emptyText:''
                ,name: 'animalGroup'
                ,xtype: 'combo'
                ,displayField:'name'
                ,valueField: 'name'
                //,typeAhead: true
                ,width: 160
                ,editable: true
                ,triggerAction: 'all'
                ,store: new LABKEY.ext.Store({
                    containerPath: 'WNPRC/EHR/',
                    schemaName: 'ehr',
                    queryName: 'animal_groups',
                    sort: 'name',
                    autoLoad: true
                })
            });

            this.add(new Ext.Button({
                text: 'Show Group'
                ,width: 120
                ,style: 'padding-left:5px'
                ,handler: function(){
                    var value = this.animalGroup.getValue();
                    if (!value) return false;

                    window.location = LABKEY.ActionURL.buildURL(
                        'query'
                        ,'executeQuery'
                        ,'WNPRC/EHR/'
                        ,{schemaName: 'study', 'query.queryName': 'Demographics', 'query.viewName': value}
                        );
                }
                ,scope: this
                })
            );

            this.add({html: '<a href="'+(LABKEY.ActionURL.buildURL('query','executeQuery','WNPRC/EHR/',
                {
                    schemaName: 'study',
                    'query.queryName': 'Demographics',
                    'query.viewName': 'Alive, at WNPRC'
                }))+'">View All Living WNPRC Animals</a>', colspan: 2});

            this.add({html: '<Br>Project:', colspan: 2});


            this.projectField = this.add({
                emptyText:''
                ,name: 'projectField'
                ,xtype: 'combo'
                ,displayField:'project'
                ,valueField: 'project'
                //,typeAhead: true
                ,width: 160
                ,triggerAction: 'all'
                ,mode: 'local'
                ,editable: true
                ,store: new LABKEY.ext.Store({
                    containerPath: 'WNPRC/EHR/',
                    schemaName: 'lists',
                    queryName: 'project',
                    sort: 'project',
                    autoLoad: true
                })
            });

            this.add(new Ext.Button({
                text: 'Show Project'
                ,width: 120
                ,style: 'padding-left:5px'
                ,handler: function(){
                    var value = this.projectField.getValue();
                    if (!value) return false;

                    window.location = LABKEY.ActionURL.buildURL(
                        'ehr'
                        ,'projectDetails'
                        ,'WNPRC/EHR/'
                        ,{key: value});
                }
                ,scope: this
                })
            );

            this.add({html: '<a href="'+(LABKEY.ActionURL.buildURL('ehr','projectQueries','WNPRC/EHR/'))+'">Advanced Project Search</a>', colspan: 2});

            this.add({html: '<Br>Protocol:', colspan: 2});

            this.protocolField = this.add({
                emptyText:''
                ,name: 'protocolField'
                ,xtype: 'combo'
                ,displayField:'protocol'
                ,valueField: 'protocol'
                //,typeAhead: true
                ,width: 160
                ,triggerAction: 'all'
                ,mode: 'local'
                ,editable: true
                ,store: new LABKEY.ext.Store({
                    containerPath: 'WNPRC/EHR/',
                    schemaName: 'lists',
                    queryName: 'protocol',
                    sort: 'protocol',
                    autoLoad: true
                })
            });

            this.add(new Ext.Button({
                text: 'Show Protocol'
                ,width: 120
                ,style: 'padding-left:5px'
                ,handler: function(){
                    var value = this.protocolField.getValue();
                    
                    if (!value) return false;

                    window.location = LABKEY.ActionURL.buildURL(
                        'ehr'
                        ,'protocolDetails'
                        ,'WNPRC/EHR/'
                        ,{key: value});
                }
                ,scope: this
                })
            );

            this.add({html: '<a href="'+(LABKEY.ActionURL.buildURL('ehr','projectQueries','WNPRC/EHR/'))+'">Advanced Protocol Search</a>', colspan: 2});

            this.add({html: '<Br>Room:', colspan: 2});

            this.roomField = this.add(new Ext.form.TextField({
                type: 'textbox'
               ,name: 'room'
               ,width: 160
                })
            );

            this.add(new Ext.Button({
                text: 'Show Room'
                ,width: 120
                ,style: 'padding-left:5px'
                ,handler: function(){
                    var value = this.roomField.getValue();
                    if (!value) return false;

                    window.location = LABKEY.ActionURL.buildURL(
                        'query'
                        ,'executeQuery'
                        ,'WNPRC/EHR/'
                        ,{'schemaName':'study', 'query.queryName':'Demographics', 'query.Id/curLocation/Room~eq': value, 'query.viewName': 'Alive, at WNPRC'});

                }
                ,scope: this
                })
            );

            this.add({html: '<a href="'+(LABKEY.ActionURL.buildURL('ehr','housingQueries','WNPRC/EHR/'))+'">Advanced Housing Search</a>', colspan: 2});
        }
    });


    var panel = new thePanel();

    panel.render('quickSearchPanel');

}
    





</script>
</head>
<body>

<div id="quickSearchPanel"></div>

</body>
</html>