<html>
<head>
<script type="text/javascript">

/*!
 * Ext JS Library 3.2.1
 * Copyright(c) 2006-2010 Ext JS, Inc.
 * licensing@extjs.com
 * http://www.extjs.com/license
 */

LABKEY.requiresScript("/ehr/ehrAPI.js");


Ext.onReady(function(){

    var formType = LABKEY.ActionURL.getParameter('formtype');
    var formUUID = LABKEY.ActionURL.getParameter('taskid');
    var queryName = LABKEY.ActionURL.getParameter('queryName');

    if(formType){
        renderTaskForm(formType);
    }
    else if (!formType && queryName){
        renderSimpleForm(queryName);
    }
    else {
        alert('Must supply form type or query name');
    }

    function renderTaskForm(formType){
        EHR.ext.createImportPanel({
            panelType: 'TaskPanel',
            formUUID: formUUID,
            formType: formType,
            renderTo: 'taskForm',
            printFormat: true,
            allowableButtons: []
        });

        LABKEY.NavTrail.setTrail('Task: '+(LABKEY.ActionURL.getParameter('title') || formType));
    }

    function renderSimpleForm(queryName){
        EHR.ext.createSimpleTaskPanel({
            formType: LABKEY.ActionURL.getParameter('queryName'),
            formUUID: formUUID,
            queryName: LABKEY.ActionURL.getParameter('queryName'),
            schemaName: LABKEY.ActionURL.getParameter('schemaName'),
            renderTo: 'taskForm',
            printFormat: true
        });

        LABKEY.NavTrail.setTrail('Task: '+(LABKEY.ActionURL.getParameter('title') || queryName));
    }
});


</script>
</head>
<body>
<div id="taskForm"></div>



</body>


</html>